/*! leaflegend 13-07-2015 */
!function(a,b){"use strict";(function(){var b,c,d=[].slice;c=L.LeafLegend=L.Class.extend({includes:L.Mixin.Events,options:{color1:"",color2:"",steps:4,xmin:0,xmax:33798829,ymin:0,ymax:34518900,xsize:4,ysize:4,cols1:[],gdrow:[],colurschema1:[],colurschema2:[],colurschema3:[],colurschema4:[],cellColorIndex:[],xintervals:[],yintervals:[],rects:[],cell_width:[],legend_el:void 0,gridwidth:164,xintervalSize:100,yintervalSize:10,gutter_width:0,row_label_width:120,index_dicts:[],nameCols:["",""]},initialize:function(a,b){var c;c=this,L.setOptions(c,b)},color1:function(a){return this.options.color1=a,this},color2:function(a){return this.options.color2=a,this},steps:function(a){return this.options.steps=a,this},xmin:function(a){return this.options.xmin=a,this},ymin:function(a){return this.options.ymin=a,this},xmax:function(a){return this.options.xmax=a,this},ymax:function(a){return this.options.ymax=a,this},xsize:function(a){return this.options.xsize=a,this},ysize:function(a){return this.options.ysize=a,this},cols1:function(a){return this.options.cols1=a,this},gdrow:function(a){return this.options.gdrow=a,this},colurschema1:function(a){return this.options.colurschema1=a,this},colurschema2:function(a){return this.options.colurschema2=a,this},colurschema3:function(a){return this.options.colurschema3=a,this},colurschema4:function(a){return this.options.colurschema4=a,this},cellColorIndex:function(a){return this.options.cellColorIndex=a,this},rects:function(a){return this.options.rects=a,this},cell_width:function(a){return this.options.cell_width=a,this},legend_el:function(a){return this.options.legend_el=a,this},gridwidth:function(a){return this.options.gridwidth=a,this},xintervalSize:function(a){return this.options.xintervalSize=a,this},yintervalSize:function(a){return this.options.yintervalSize=a,this},gutterWidth:function(a){return this.options.gutter_width=a,this},rowLabelWidth:function(a){return this.options.row_label_width=a,this},indexDicts:function(a){return this.options.index_dicts=a,this},nameCols:function(a){return this.options.nameCols=a,this},nameLegCols:function(a){return this.nameCols(a)},makeGrid:function(){var a,b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,aa,ba;for(g=this.options.color1,h=this.options.color2,G=this.options.steps,t=G,s=t,J=this.options.steps,O=this.options.steps,y=1/s,a=[],x=S=0;s>=0?s>S:S>s;x=s>=0?++S:--S)a.push("$#palette"+x);for(E=[],x=T=0;s>=0?s>T:T>s;x=s>=0?++T:--T)E.push('=$("#pallet'+x+'")');for(D=U=0;s>=0?s>U:U>s;D=s>=0?++U:--U)E[D]=a[D];for(k=[],l=[],m=[],n=[],I=V=0;1>V;I=V+=y)k.push(chroma.interpolate(g,"white",I,"lab").hex()),l.push(chroma.interpolate("white",h,I,"lab").hex()),m.push(chroma.interpolate(g,"black",I,"lab").hex()),n.push(chroma.interpolate("black",h,I,"lab").hex());for(j=[],i=[],p=[],x=W=0;s>=0?s>W:W>s;x=s>=0?++W:--W)j.push("colurs"+x);for(j[x],o=j[x]=[],I=X=0;s>=0?s>X:X>s;I=s>=0?++X:--X)if(void 0===I);else for(e=m[I],f=l[I],C=Y=0;1>Y;C=Y+=y)i.push(chroma.interpolate(e,f,C,"lab"));for(K=this.options.xmax/J,M=[],x=Z=0;J>=0?J>Z:Z>J;x=J>=0?++Z:--Z)M.push(this.options.xmin+x*K);for(P=this.options.ymax/this.options.ysize,Q=[],x=_=0;O>=0?O>_:_>O;x=O>=0?++_:--_)Q.push(this.options.ymin+x*P);for(this.xintervals=M,this.yintervals=Q,this.options.xintervals=M,this.options.yintervals=Q,this.colurschema1(k),this.colurschema2(l),this.colurschema3(m),this.colurschema4(n),this.cols1(i),this.options.xintervalSize=K,this.xintervalSize(K),this.yintervalSize(P),c=this,G=c.options.steps,N=c.options.xsize,R=c.options.ysize,b="checked",d=40,v=3,y=1/s,G=c.options.steps,this.cell_width(d),this.gutterWidth(v),u=G*(d+v),this.gridwidth(u),F=[],H=u,w=u,void 0===B?(B=L.DomUtil.create("div","info legend"),B.setAttribute("id","leaflegend"),$("body").append(B)):B=this.options.legend_el,A=$(B),this._div=A,A.css("width",u+this.options.row_label_width),A.css("height",u),A.css("margin-right",d),A.css("margin-bottom",2*d),A.css("width",u+this.options.row_label_width).html(""),q={},r=[],D=0,x=aa=0;N>=0?N>aa:aa>N;x=N>=0?++aa:--aa)for(z=ba=0;R>=0?R>ba:ba>R;z=R>=0?++ba:--ba)void 0===this.options.cols1[x*N+z]||(void 0!==M[z+1]&&r.push({i:D,x:""+M[z]+"-"+M[z+1],y:""+Q[z]+" &ndash; "+Q[z+1],c:this.options.cols1[x*N+z]}),void 0===M[z+1]&&r.push({i:D,x:""+M[z]+"-"+this.options.xmax,y:""+Q[z]+" &ndash; "+this.options.ymax,c:this.options.cols1[x*N+z]}),D+=1);return this.gdrow(r),this},getLegendHTML:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H;for(this.map=a,this._m=a,A=this.options.xmin,D=this.options.ymin,z=this.options.xintervalSize,C=this.options.yintervalSize,g=this.options.gdrow,B=this.options.xsize,E=this.options.ysize,w=this.options.legend_el,t=[],u=[],v=[],this._legendObject=[],b=this.options.cell_width,o=0,n=this.options.steps*this.options.cell_width/10.5,m=this.options.color1,s=-90,p=-90,r=this.options.steps*this.options.cell_width/19,q=this.options.color2,f=void 0,y=void 0,j=0,k=3.5,h=g.slice(0,4),h.reverse(),u.push('<span style="height:'+this.options.cell_width+'px;"><div style="width:'+2*this.options.cell_width+("px; position: relative; height: 0; text-align: left; color: "+m+"; font-weight: bold;")+("  -webkit-transform: translate("+(k-k)+"em,"+n+"em); -moz-transform: translate("+(k-k)+"em,"+n+"em); -o-transform: translate("+(k-k)+"em,"+n+"em); -ms-transform: translate("+(k-k)+"em,"+n+"em); transform: translate("+(k-k)+"em,"+n+'em);">')+('<div style="-webkit-transform: rotate('+o+"deg); -moz-transform: rotate("+o+'deg);">')+this.options.nameCols[1]+"</div></div></span>"),c=F=0;E>=0?E>F:F>E;c=E>=0?++F:--F)u.push('<span style="height:'+this.options.cell_width+'px;"><div style="width:'+2*this.options.cell_width+("px; position: relative; height: 0; text-align: left; color: "+m+";")+("  -webkit-transform: translate("+(c-.5)*k+"em,-6em); -moz-transform: translate("+(c-.5)*k+"em,-6em); -o-transform: translate("+(c-.5)*k+"em,-6em); -ms-transform: translate("+(c-.5)*k+"em,"+-b/7+"em); -webkit-transform: translate("+(c-.5)*k+"em,"+-b/7+"em); transform: translate("+(c-.5)*k+"em,"+-b/7+'em);">')+('<div style="-webkit-transform: rotate('+p+"deg); -moz-transform: rotate("+p+'deg);">')+h[c].y+"</div></div></span>");for(u.push('<span style="height:'+this.options.cell_width+'px;"><div style="width:'+2*this.options.cell_width+("px; position: relative; height: 0; text-align: left;  color: "+q+"; font-weight: bold;")+("  -webkit-transform: translate("+-b/7+"em,"+r+"em); -moz-transform: translate("+-b/7+"em,"+r+"em); -o-transform: translate("+-b/7+"em,"+r+"em); -ms-transform: translate("+-b/7+"em,"+r+"em); transform: translate("+-b/7+"em,"+r+"em); -webkit-transform: translate("+-b/7+"em,"+r+'em);">')+('<div style="-webkit-transform: rotate('+s+"deg); -moz-transform: rotate("+s+'deg);">')+this.options.nameCols[0]+"</div></div></span>"),l=G=0;E>=0?E>G:G>E;l=E>=0?++G:--G){for(v=[],f=g[l].i*z,d=g[l],j=H=0;B>=0?B>H:H>B;j=B>=0?++H:--H)v.push('<span class="swatch" style="background:'+g[l*B+j].c+"; position: initial; display:block; float:left; height:"+this.options.cell_width+"px; width:"+this.options.cell_width+'px;"id='+g[l*B+j].i+"></span> "),v.push('<span class="swatch-gutter" style="background:none; position: relative; display:block; float:left; height:'+this.options.cell_width+"px; width:"+this.options.gutter_width+'px;"></span> '),j++;y=g[l+1].i*z,i=this.options.gridwidth+this.options.row_label_width,u.push('<li style="height:'+this.options.gutter_width+"px; position: relative; width:"+i+'px;"></li>'),u.push('<li style="height:'+this.options.cell_width+("px;  color: "+q+"; position: relative; width:")+i+'px;">'+v.join("")+"     "+g[l].x+"</li>"),this._legendObject.push(u),l++}t.push('<ul style="width: '+i+'px; list-style-type:none">'+u.join("")+"</ul>"),x=L.Control.extend({options:{position:"bottomright"},onAdd:function(a){return function(b){void 0===a._m&&(a._m=b),void 0===a._legendDomEl&&(a._legendDomEl=L.DomUtil.create("div","info legend"),a._legendDomEl.setAttribute("id","leaflegend"),a._m.getPanes().overlayPane.appendChild(a._legendDomEl))}}(this)}),e=document.getElementById("leaflegend"),e.innerHTML+=t,L.DomEvent.addListener(e,"mouseover",function(a){var b,c,d;$(a.target).css("cursor","pointer"),"swatch"===$(a.target).prop("class")&&($(a.target).css("border","3px solid white"),$(a.target).css("opacity","0.8"),$(a.target).css("border-radius","10%")),c=this._m._layers;for(b in c)d=c[b],d.options&&d.options.className==="range-"+a.target.id&&(d.bringToFront(),d.setStyle({color:"white",weight:3,opacity:.9,fillOpacity:.9}))},this),L.DomEvent.addListener(e,"mouseout",function(a){var b,c,d;$(a.target).css("cursor","default"),c=this._m._layers,$(a.target).css("border","0px solid white"),$(a.target).css("opacity","1"),$(a.target).css("border-radius","0%");for(b in c)d=c[b],d.options&&d.options.className==="range-"+a.target.id&&d.setStyle({color:"black",weight:1,opacity:.4,fillOpacity:1})},this)},addTo:function(a){return a.addLayer(this),this},getIndexByColor:function(a){var b,c,d,e,f,g,h,i,j;for(j=this.options.gdrow,h=0,i=j.length;i>h;h++){c=j[h],d=c.x.split("-")[0],e=c.x.split("-")[1],f=c.y.split("-")[0],g=c.y.split("-")[1];try{if(c.c.hex()===a.target.options.fillColor.hex())try{return c.i}catch(k){b=k}}catch(k){if(b=k,c.c.hex()===a.layer.options.fillColor.hex())return c.i}}},highlightByFeature:function(a){var b,c,d,e,f,g;if(a.target.options)b=a.target.options.className;else{g=a.target._layers;for(d in g)f=g[d],void 0!==f.options.className&&(b=f.options.className)}return c=b.replace("range-",""),e=L.DomUtil.get(c),$(e).css("border","3px solid white"),$(e).css("border-radius","10%")},resetHighlightByFeature:function(a){var b,c,d,e,f,g;if(a.target.options)b=a.target.options.className;else{g=a.target._layers;for(d in g)f=g[d],void 0!==f.options.className&&(b=f.options.className)}return c=b.replace("range-",""),e=L.DomUtil.get(c),$(e).css("border","0px solid white"),$(e).css("border-radius","0%")},getColorByRangeAndSize:function(a,b){var c,d,e,f;e=Math.floor(a/this.options.xintervalSize),f=Math.floor(b/this.options.yintervalSize),this.cellColorIndex=f*this.options.xsize+e,this.cellColor=this.options.gdrow[this.cellColorIndex];try{return d=this.options.index_dicts,d.push({i:this.cellColor.i,x_val:a,y_val:b,x:this.cellColor.x,y:this.cellColor.y,color:this.cellColor.c}),this.indexDicts(d),this.cellColor}catch(g){return c=g,this.cellColor=NaN}}}),L.control.command=function(a){return new L.Control.Command(a)},L.leaflegend=function(a,b){return new L.LeafLegend(a,b)},b=function(a,b,c){return a[c]=function(){var e;return e=1<=arguments.length?d.call(arguments,0):[],0===e.length?a[b][c]:(a[b][c]=e[0],a)}},c.VERSION="0.0.0",a.leaflegend=c}).call(this)}(this);