/*! leaflegend 02-02-2015 */
!function(a){"use strict";(function(){var b,c,d=[].slice;c=L.LeafLegend=L.Class.extend({includes:L.Mixin.Events,options:{color1:"",color2:"",steps:4,xmin:0,xmax:49,ymin:0,ymax:1190,xsize:4,ysize:4,cols1:[],gdrow:[],colurschema1:[],colurschema2:[],colurschema3:[],colurschema4:[],cellColorIndex:[],xintervals:[],yintervals:[],rects:[],cell_width:[],legend_el:void 0,gridwidth:164,xintervalSize:100,yintervalSize:10,gutter_width:0,row_label_width:120,index_dicts:[],nameCols:["",""]},initialize:function(a,b){var c;c=this,L.setOptions(c,b)},color1:function(a){return this.options.color1=a,this},color2:function(a){return this.options.color2=a,this},steps:function(a){return this.options.steps=a,this},xmin:function(a){return this.options.xmin=a,this},ymin:function(a){return this.options.ymin=a,this},xmax:function(a){return this.options.xmax=a,this},ymax:function(a){return this.options.ymax=a,this},xsize:function(a){return this.options.xsize=a,this},ysize:function(a){return this.options.ysize=a,this},cols1:function(a){return this.options.cols1=a,this},gdrow:function(a){return this.options.gdrow=a,this},colurschema1:function(a){return this.options.colurschema1=a,this},colurschema2:function(a){return this.options.colurschema2=a,this},colurschema3:function(a){return this.options.colurschema3=a,this},colurschema4:function(a){return this.options.colurschema4=a,this},cellColorIndex:function(a){return this.options.cellColorIndex=a,this},rects:function(a){return this.options.rects=a,this},cell_width:function(a){return this.options.cell_width=a,this},legend_el:function(a){return this.options.legend_el=a,this},gridwidth:function(a){return this.options.gridwidth=a,this},xintervalSize:function(a){return this.options.xintervalSize=a,this},yintervalSize:function(a){return this.options.yintervalSize=a,this},gutterWidth:function(a){return this.options.gutter_width=a,this},rowLabelWidth:function(a){return this.options.row_label_width=a,this},indexDicts:function(a){return this.options.index_dicts=a,this},nameCols:function(a){return this.options.nameCols=a,this},nameLegCols:function(a){return this.nameCols(a)},makeGrid:function(){var a,b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,ab,bb;for(g=this.options.color1,h=this.options.color2,G=this.options.steps,t=G,s=t,J=this.options.steps,O=this.options.steps,y=1/s,a=[],x=S=0;s>=0?s>S:S>s;x=s>=0?++S:--S)a.push("$#palette"+x);for(E=[],x=T=0;s>=0?s>T:T>s;x=s>=0?++T:--T)E.push('=$("#pallet'+x+'")');for(D=U=0;s>=0?s>U:U>s;D=s>=0?++U:--U)E[D]=a[D];for(k=[],l=[],m=[],n=[],I=V=0;1>V;I=V+=y)k.push(chroma.interpolate(g,"black",I,"lab").hex()),l.push(chroma.interpolate("black",h,I,"lab").hex()),m.push(chroma.interpolate(g,"white",I,"lab").hex()),n.push(chroma.interpolate("white",h,I,"lab").hex());for(j=[],i=[],p=[],x=W=0;s>=0?s>W:W>s;x=s>=0?++W:--W)j.push("colurs"+x);for(j[x],o=j[x]=[],I=X=0;s>=0?s>X:X>s;I=s>=0?++X:--X)if(void 0===I);else for(e=m[I],f=l[I],C=Y=0;1>Y;C=Y+=y)i.push(chroma.interpolate(e,f,C,"lab"));for(K=this.options.xmax/J,M=[],x=Z=0;J>=0?J>Z:Z>J;x=J>=0?++Z:--Z)M.push(this.options.xmin+x*K);for(P=this.options.ymax/this.options.ysize,Q=[],x=_=0;O>=0?O>_:_>O;x=O>=0?++_:--_)Q.push(this.options.ymin+x*P);for(this.xintervals=M,this.yintervals=Q,this.options.xintervals=M,this.options.yintervals=Q,this.colurschema1(k),this.colurschema2(l),this.colurschema3(m),this.colurschema4(n),this.cols1(i),this.options.xintervalSize=K,this.xintervalSize(K),this.yintervalSize(P),c=this,G=c.options.steps,N=c.options.xsize,R=c.options.ysize,b="checked",d=40,v=3,y=1/s,G=c.options.steps,this.cell_width(d),this.gutterWidth(v),u=G*(d+v),this.gridwidth(u),F=[],H=u,w=u,void 0===B?(B=L.DomUtil.create("div","info legend"),B.setAttribute("id","leaflegend"),$("body").append(B)):B=this.options.legend_el,A=$(B),this._div=A,A.css("width",u+this.options.row_label_width),A.css("height",u),A.css("margin-right",d),A.css("margin-bottom",2*d),A.css("width",u+this.options.row_label_width).html(""),q={},r=[],D=0,x=ab=0;N>=0?N>ab:ab>N;x=N>=0?++ab:--ab)for(z=bb=0;R>=0?R>bb:bb>R;z=R>=0?++bb:--bb)void 0===this.options.cols1[x*N+z]||(void 0!==M[z+1]&&r.push({i:D,x:""+M[z]+"-"+M[z+1],y:""+Q[z]+" &ndash; "+Q[z+1],c:this.options.cols1[x*N+z]}),void 0===M[z+1]&&r.push({i:D,x:""+M[z]+"-"+this.options.xmax,y:""+Q[z]+" &ndash; "+this.options.ymax,c:this.options.cols1[x*N+z]}),D+=1);return this.gdrow(r),this},getLegendHTML:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;for(this.map=a,this._m=a,r=this.options.xmin,u=this.options.ymin,q=this.options.xintervalSize,t=this.options.yintervalSize,f=this.options.gdrow,s=this.options.xsize,v=this.options.ysize,n=this.options.legend_el,k=[],l=[],m=[],this._legendObject=[],e=void 0,p=void 0,h=0,i=3.5,l.push('<span style="height:'+this.options.cell_width+'px;"><div style="width:'+2*this.options.cell_width+"px; position: relative; height: 0; text-align: left; font-weight: bold;"+("  -webkit-transform: translate("+(1*i-6-i)+"em,-7em); -moz-transform: translate("+(1*i-6-i)+"em,-7em); -o-transform: translate("+(1*i-6-i)+"em,-7em); -ms-transform: translate("+(1*i-6-i)+"em,-7em); transform: translate("+(1*i-4-i)+'em,-5em);">')+'<div style="-webkit-transform: rotate(-45deg); -moz-transform: rotate(-45deg);">'+this.options.nameCols[1]+"</div></div></span>"),b=w=0;v>=0?v>w:w>v;b=v>=0?++w:--w)l.push('<span style="height:'+this.options.cell_width+'px;"><div style="width:'+2*this.options.cell_width+"px; position: relative; height: 0; text-align: left;"+("  -webkit-transform: translate("+(b*i+1-i)+"em,-6em); -moz-transform: translate("+(b*i+1-i)+"em,-6em); -o-transform: translate("+(b*i+1-i)+"em,-6em); -ms-transform: translate("+(b*i+1-i)+"em,-6em); transform: translate("+(b*i+4-i)+'em,-4em);">')+'<div style="-webkit-transform: rotate(-45deg); -moz-transform: rotate(-45deg);">'+f[b].y+"</div></div></span>");for(l.push('<span style="height:'+this.options.cell_width+'px;"><div style="width:'+2*this.options.cell_width+"px; position: relative; height: 0; text-align: left; font-weight: bold;"+("  -webkit-transform: translate("+(s*i+6+i)+"em,-7em); -moz-transform: translate("+(s*i+6+i)+"em,-7em); -o-transform: translate("+(s*i+6+i)+"em,-7em); -ms-transform: translate("+(s*i+6+i)+"em,-7em); transform: translate("+(s*i+2)+"em,"+v*i+'em);">')+'<div style="-webkit-transform: rotate(0deg); -moz-transform: rotate(0deg);">'+this.options.nameCols[0]+"</div></div></span>"),j=x=0;v>=0?v>x:x>v;j=v>=0?++x:--x){for(m=[],e=f[j].i*q,c=f[j],h=y=0;s>=0?s>y:y>s;h=s>=0?++y:--y)m.push('<span class="swatch" style="background:'+f[j*s+h].c+"; position: initial;  display:block; float:left; height:"+this.options.cell_width+"px; width:"+this.options.cell_width+'px;"id='+f[j*s+h].i+"></span> "),m.push('<span class="swatch-gutter" style="background:white; position: relative; display:block; float:left; height:'+this.options.cell_width+"px; width:"+this.options.gutter_width+'px;"></span> '),h++;p=f[j+1].i*q,g=this.options.gridwidth+this.options.row_label_width,l.push('<li style="height:'+this.options.gutter_width+"px; position: relative; width:"+g+'px;"></li>'),l.push('<li style="height:'+this.options.cell_width+"px; position: relative; width:"+g+'px;">'+m.join("")+"     "+f[j].x+"</li>"),this._legendObject.push(l),j++}k.push('<ul style="width: '+g+'px; list-style-type:none">'+l.join("")+"</ul>"),o=L.Control.extend({options:{position:"bottomright"},onAdd:function(a){return function(b){void 0===a._m&&(a._m=b),void 0===a._legendDomEl&&(a._legendDomEl=L.DomUtil.create("div","info legend"),a._legendDomEl.setAttribute("id","leaflegend"),a._m.getPanes().overlayPane.appendChild(a._legendDomEl))}}(this)}),d=document.getElementById("leaflegend"),d.innerHTML+=k,L.DomEvent.addListener(d,"mouseover",function(a){var b,c,d;$(a.target).css("cursor","pointer"),"swatch"===$(a.target).prop("class")&&($(a.target).css("border","3px solid white"),$(a.target).css("opacity","0.8"),$(a.target).css("border-radius","10%")),c=this._m._layers;for(b in c)d=c[b],d.options&&d.options.className==="range-"+a.target.id&&(d.bringToFront(),d.setStyle({weight:3,opacity:.9,fillOpacity:.9}))},this),L.DomEvent.addListener(d,"mouseout",function(a){var b,c,d;$(a.target).css("cursor","default"),c=this._m._layers,$(a.target).css("border","0px solid white"),$(a.target).css("opacity","1"),$(a.target).css("border-radius","0%");for(b in c)d=c[b],d.options&&d.options.className==="range-"+a.target.id&&d.setStyle({weight:1,opacity:.4,fillOpacity:1})},this)},addTo:function(a){return a.addLayer(this),this},getIndexByColor:function(a){var b,c,d,e,f,g,h,i,j;for(j=this.options.gdrow,h=0,i=j.length;i>h;h++){c=j[h],d=c.x.split("-")[0],e=c.x.split("-")[1],f=c.y.split("-")[0],g=c.y.split("-")[1];try{if(c.c.hex()===a.target.options.fillColor.hex())try{return c.i}catch(k){b=k}}catch(k){if(b=k,c.c.hex()===a.layer.options.fillColor.hex())return c.i}}},highlightByFeature:function(a){var b,c,d,e,f,g;if(a.target.options)b=a.target.options.className;else{g=a.target._layers;for(d in g)f=g[d],void 0!==f.options.className&&(b=f.options.className)}return c=b.replace("range-",""),e=L.DomUtil.get(c),$(e).css("border","3px solid white"),$(e).css("border-radius","10%")},resetHighlightByFeature:function(a){var b,c,d,e,f,g;if(a.target.options)b=a.target.options.className;else{g=a.target._layers;for(d in g)f=g[d],void 0!==f.options.className&&(b=f.options.className)}return c=b.replace("range-",""),e=L.DomUtil.get(c),$(e).css("border","0px solid white"),$(e).css("border-radius","0%")},getColorByRangeAndSize:function(a,b){var c,d,e,f;e=Math.floor(a/this.options.xintervalSize),f=Math.floor(b/this.options.yintervalSize),this.cellColorIndex=f*this.options.xsize+e,this.cellColor=this.options.gdrow[this.cellColorIndex];try{return d=this.options.index_dicts,d.push({i:this.cellColor.i,x_val:a,y_val:b,x:this.cellColor.x,y:this.cellColor.y,color:this.cellColor.c}),this.indexDicts(d),this.cellColor}catch(g){return c=g,this.cellColor=0/0}}}),L.control.command=function(a){return new L.Control.Command(a)},L.leaflegend=function(a,b){return new L.LeafLegend(a,b)},b=function(a,b,c){return a[c]=function(){var e;return e=1<=arguments.length?d.call(arguments,0):[],0===e.length?a[b][c]:(a[b][c]=e[0],a)}},c.VERSION="0.0.0",a.leaflegend=c}).call(this)}(this);